<!--suppress BadExpressionStatementJS -->
<html metal:use-macro="load: ../base_layout.pt">
<!DOCTYPE html>
<html lang="${request.locale_name}">
<head>
</head>

<body>
<metal:block fill-slot="content">
    <div class="container">

        <div class="row">
            <div class="col-md-10 col-md-offset-1 text-center">
                <h1 id="title"></h1>
            </div>
        </div>
        <div class="row">
            <div class="col-md-10 col-md-offset-1">
                <h3>Tissues</h3>
            </div>
            <div class="col-md-10 col-md-offset-1">
                <img id="heart" width="60px" src="../static/images/herz_cut.svg">
                <img id="brain" width="60px" style="opacity: 0.3" src="../static/images/hirn Kopie_cut.svg">
                <img id="spleen" width="60px" src="../static/images/milz Kopie_cut.svg">
                <img id="breast" width="60px" style="opacity: 0.3" src="../static/images/brust Kopie_cut.svg">
                <img id="uterus" width="60px" src="../static/images/uterus Kopie_cut.svg">
                <img id="prostate" width="60px" src="../static/images/prostata_hoden Kopie_cut.svg">
                <img id="lung" width="60px" style="opacity: 0.3" src="../static/images/lungen Kopie_cut.svg">
                <img id="kidney" width="60px" src="../static/images/niere Kopie_cut.svg">
                <img id="bladder" width="60px" src="../static/images/blase Kopie_cut.svg">
                <img id="liver" width="60px" style="opacity: 0.3" src="../static/images/Leber Kopie_cut.svg">
                <img id="skin" width="60px" src="../static/images/Haut Kopie_cut.svg">
                <img id="stomach" width="60px" src="../static/images/magen Kopie_cut.svg">
                <img id="pancreas" width="60px" style="opacity: 0.3" src="../static/images/pancreas Kopie_cut.svg">
                <img id="thyroid" width="60px" style="opacity: 0.3" src="../static/images/schilddrÃ¼se Kopie_cut.svg">

            </div>
        </div>
        <br>

        <div class="row">
            <div class="col-md-5 col-md-offset-1">
                <h3>Source Antigen</h3>

                <table class="table table-striped table-bordered" id="proteins">
                    <thead>
                    <tr>
                        <td>Proteins</td>
                        <td>Gene Name</td>
                        <td>Uniprot</td>
                        <td>Position</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td></td>
                        <td></td>
                    </tr>
                    </tbody>
                </table>


                <h3>HLA</h3>

                <h3>Class 1</h3>

                <div class="row no-gutters">
                    <div class="col-md-4">
                        <table class="table table-striped table-bordered" id="hla_class1_A">
                            <thead>
                            <tr>
                                <td>HLA-A</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-4">
                        <table class="table table-striped table-bordered" id="hla_class1_B">
                            <thead>
                            <tr>
                                <td>HLA-B</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-4">
                        <table class="table table-striped table-bordered" id="hla_class1_C">
                            <thead>
                            <tr>
                                <td>HLA-C</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
            </div>

                <h3>Class 2</h3>

                <div class="row no-gutters">
                    <div class="col-md-3">
                        <table class="table table-striped table-bordered" id="hla_class2_DPB">
                            <thead>
                            <tr>
                                <td>HLA-DPB</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-3">
                        <table class="table table-striped table-bordered" id="hla_class2_DQA">
                            <thead>
                            <tr>
                                <td>HLA-DQA</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="col-md-3">
                        <table class="table table-striped table-bordered" id="hla_class2_DQB">
                            <thead>
                            <tr>
                                <td>HLA-DQB</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-3">
                        <table class="table table-striped table-bordered" id="hla_class2_DRB">
                            <thead>
                            <tr>
                                <td>HLA-DRB</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
            </div>

        </div>

            <div class="col-md-5">
                <h3>Experimental Evidence</h3>
                The peptide was found in ${ms_run_count} MS runs with <a href="/peptide_spectra/${peptide}" >${psms} PSMs</a>.

                <br>

                <h3>Related Information</h3>
                SYFPEITHI
                <a href="http://www.syfpeithi.de/"><span class="glyphicon glyphicon-globe"
                                                         aria-hidden="true"></span></a>
                <br>
                IEDB <a href="http://www.iedb.org/epitope/58560"><span class="glyphicon glyphicon-globe"
                                                                       aria-hidden="true"></span></a>
                <br>
                PubMed
                <a href="http://www.ncbi.nlm.nih.gov/pubmed/?term="><span class="glyphicon glyphicon-globe"
                                                                          aria-hidden="true"></span></a>
        </div>
    </div>
</div>

<script>


    $(document).ready(function () {
        // Setting the title
        document.getElementById("title").innerHTML = "${peptide}";
    });
    $(document).ready(function () {
// create dataTable
        //"pageLength": 50
        var class1_length = Math.max(${hla_class1_A}.length, ${hla_class1_B}.length,${hla_class1_C}.length)

        //console.log(class1_length);
        var tab = $('#hla_class1_A').DataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            "defaultContent": 'No entries to show',
            "searching": false,
            data: ${hla_class1_A},
            columns: [
                {"render": function (data, type, row) {
                    return "<a class='nostylelink'  href= '/hla/" + data + "'>" + data + "</a>";
                }}
            ]
        });
        for (var i = 1; i <= class1_length -${hla_class1_A}.length;i++)
        {
            tab.row.add(["-"]).draw();
        }

        var tab = $('#hla_class1_B').DataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            searching: false,
            data: ${hla_class1_B},
            columns: [
                {"render": function (data, type, row) {
                    return "<a class='nostylelink'  href= '/hla/" + data + "'>" + data + "</a>";
                }}
            ]
        });

        for (var i = 1; i <= class1_length -${hla_class1_B}.length;i++)
        {
            tab.row.add(["-"]).draw();
        }

        var tab = $('#hla_class1_C').DataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            searching: false,
            data: ${hla_class1_C},
            columns: [
                {"render": function (data, type, row) {
                    return "<a class='nostylelink'  href= '/hla/" + data + "'>" + data + "</a>";
                }}
            ]
        });

        for (var i = 1; i <= class1_length -${hla_class1_C}.length;i++)
        {
            tab.row.add(["-"]).draw();
        }


        var class2_length = Math.max(${hla_class2_DPB}.length, ${hla_class2_DQA}.length,${hla_class2_DQB}.length,${hla_class2_DRB}.length)
        var tab = $('#hla_class2_DPB').DataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            searching: false,
            data: ${hla_class2_DPB},
            columns: [
                {"render": function (data, type, row) {
                    return "<a class='nostylelink'  href= '/hla/" + data + "'>" + data + "</a>";
                }}
            ]
        });
        for (var i = 1; i <= class2_length -${hla_class2_DPB}.length;i++)
        {
            tab.row.add(["-"]).draw();
        }

        var tab = $('#hla_class2_DQA').DataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            searching: false,
            data: ${hla_class2_DQA},
            columns: [
                {"render": function (data, type, row) {
                    return "<a class='nostylelink'  href= '/hla/" + data + "'>" + data + "</a>";
                }}
            ]
        });
        for (var i = 1; i <= class2_length -${hla_class2_DQA}.length;i++)
        {
            tab.row.add(["-"]).draw();
        }

        var tab = $('#hla_class2_DQB').DataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            searching: false,
            data: ${hla_class2_DQB},
            columns: [
                {"render": function (data, type, row) {
                    return "<a class='nostylelink'  href= '/hla/" + data + "'>" + data + "</a>";
                }}
            ]
        });
        for (var i = 1; i <= class2_length -${hla_class2_DQB}.length;i++)
        {
            tab.row.add(["-"]).draw();
        }

        var tab = $('#hla_class2_DRB').DataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            searching: false,
            data: ${hla_class2_DRB},
            columns: [
                {"render": function (data, type, row) {
                    return "<a class='nostylelink'  href= '/hla/" + data + "'>" + data + "</a>";
                }}
            ]
        });
        for (var i = 1; i <= class2_length -${hla_class2_DRB}.length;i++)
        {
            tab.row.add(["-"]).draw();
        }





        $('#proteins').dataTable({
            "paging": false,
            "ordering": false,
            "info": false,
            searching: false,
            data: ${proteins},
            columns: [
                {data: "protein",
                    "render": function (data, type, row) {
                        return "<a class='nostylelink'  href= '/protein/" + data + "'>" + data + "</a>";
                    }},
                {data: "gene_name"},
                {data: "protein",
                    "render": function (data, type, row) {
                        return "<a class='nostylelink'  href= 'http://www.uniprot.org/uniprot/" + data + "'>" + "Link" + "</a>";
                    }},
                {data: "sequence",
                    "render": function (data, type, row) {
                        var n = data.indexOf("${peptide}");
                        // TODO: does not work if the peptide is twice in the same protein
                        return (n + 1) + " - " + (n + "${peptide}".length);
                    }
                }

            ]
        });
    });

</script>

</metal:block>

</body>

</html>
</html>